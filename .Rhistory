caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
devtools::install_github("hrbrmstr/ggalt")
gg <- ggplot(df, aes(y=reorder(category, pct), x=pct))
gg <- gg + geom_lollipop(point.colour="steelblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, 1))
gg
gg <- ggplot(df, aes(y=reorder(category, pct), x=pct))
gg <- gg + geom_lollipop(point.colour="steelblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, 1))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(grade, aes(y=grade, x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, 1))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(grade, aes(y=grade, x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, 1))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg
gg <- ggplot(grade, aes(y=grade, x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg
gg <- ggplot(grade, aes(y=grade, x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(grade, aes(y=reorder(grade), x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(grade, aes(y=reorder(grade, percent), x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(grade, aes(y=reorder(percent, grade), x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(grade, aes(y=grade, x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(grade, aes(y=grade, x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
gg <- gg + scale_y_reverse()
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
grade <- ct_loans %>%
group_by(grade) %>%
summarise(total=n()) %>%
mutate(percent=round(total/sum(total),2)) %>%
select(grade, percent) %>%
mutate(grade=factor(grade), grade=factor(grade, levels=rev(levels(grade))))
gg <- ggplot(grade, aes(y=grade, x=percent))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="SUNY Cortland Multicultural Alumni survey results",
subtitle="Ranked by race, ethnicity, home land and orientation\namong the top areas of concern",
caption="Data from http://stephanieevergreen.com/lollipop/")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
purpose <- ct_loans %>%
group_by(purpose) %>%
summarise(total=n(), sum=sum(loan_amnt), average=mean(loan_amnt)) %>%
mutate(percent=round(total/sum(total)*100,2)) %>%
mutate(grade=factor(purpose), purpose=factor(purpose, levels=rev(levels(purpose))))
gg <- ggplot(purpose, aes(y=purpose, x=total))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0), labels=percent,
breaks=seq(0, 1, by=0.2))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Purpose of loans in Connecticut",
subtitle="Lending Club data between 2007 and 2015. Interest rates ranged from 5.32 percent to 28.49 percent, depending on the grade assigned to the loan from A to G.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
purpose <- ct_loans %>%
group_by(purpose) %>%
summarise(total=n(), sum=sum(loan_amnt), average=mean(loan_amnt)) %>%
mutate(percent=round(total/sum(total)*100,2)) %>%
mutate(grade=factor(purpose), purpose=factor(purpose, levels=rev(levels(purpose))))
gg <- ggplot(purpose, aes(y=purpose, x=total))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),
breaks=seq(0, 1, by=0.2))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Purpose of loans in Connecticut",
subtitle="Lending Club data between 2007 and 2015. Interest rates ranged from 5.32 percent to 28.49 percent, depending on the grade assigned to the loan from A to G.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
purpose
purpose <- ct_loans %>%
group_by(purpose) %>%
summarise(total=n(), sum=sum(loan_amnt), average=mean(loan_amnt)) %>%
mutate(percent=round(total/sum(total)*100,2)) %>%
mutate(purpose=factor(purpose), purpose=factor(purpose, levels=rev(levels(purpose))))
gg <- ggplot(purpose, aes(y=purpose, x=total))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),
breaks=seq(0, 1, by=0.2))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Purpose of loans in Connecticut",
subtitle="Lending Club data between 2007 and 2015. Interest rates ranged from 5.32 percent to 28.49 percent, depending on the grade assigned to the loan from A to G.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=total))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),
breaks=seq(0, 1, by=0.2), limits=c(0, .5))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Purpose of loans in Connecticut",
subtitle="Lending Club data between 2007 and 2015. Interest rates ranged from 5.32 percent to 28.49 percent, depending on the grade assigned to the loan from A to G.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=total))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),
breaks=seq(0, 1, by=0.2), limits=c(0, max(total)))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Purpose of loans in Connecticut",
subtitle="Lending Club data between 2007 and 2015. Interest rates ranged from 5.32 percent to 28.49 percent, depending on the grade assigned to the loan from A to G.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=sum))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),
breaks=seq(0, 1, by=0.2), limits=c(0, max(total)))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Total loan amounts issued in Connecticut",
subtitle="Lending Club data between 2007 and 2015.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=average))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),
breaks=seq(0, 1, by=0.2), limits=c(0, max(total)))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Average loan amount issued in Connecticut",
subtitle="By purpose. Lending Club data between 2007 and 2015.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=average))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),labels=dollar
breaks=seq(0, 1, by=0.2), limits=c(0, max(total)))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Average loan amount issued in Connecticut",
subtitle="By purpose. Lending Club data between 2007 and 2015.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=average))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),labels=dollar_format
breaks=seq(0, 1, by=0.2), limits=c(0, max(total)))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Average loan amount issued in Connecticut",
subtitle="By purpose. Lending Club data between 2007 and 2015.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=average))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),labels=dollar
breaks=seq(0, 1, by=0.2), limits=c(0, max(total)))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Average loan amount issued in Connecticut",
subtitle="By purpose. Lending Club data between 2007 and 2015.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
gg <- ggplot(purpose, aes(y=purpose, x=average))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),labels=dollar,
breaks=seq(0, 1, by=0.2), limits=c(0, max(total)))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Average loan amount issued in Connecticut",
subtitle="By purpose. Lending Club data between 2007 and 2015.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
years <- ct_loans %>%
group_by(year) %>%
summarise(loans=n())
ggplot(years, aes(x=year, y=loans)) + geom_line()
years
ggplot(years, aes(x=year, y=loans, group=1)) + geom_line()
ggplot(years, aes(x=year, y=loans, group=1)) + geom_line() +
labs(x = "Year", y = "Number of loans",
title = "LendingClub loans issued over time")
ggplot(years, aes(x=year, y=loans, group=1)) + geom_line() +
labs(x = "Year", y = "Number of loans",
title = "LendingClub loans issued over time") +
theme_minimal(base_family="Arial Narrow") +
theme(panel.grid.major.y=element_blank()) +
theme(panel.grid.minor=element_blank())
grade <- ct_loans %>%
group_by(grade) %>%
dplyr::summarise(total=n()) %>%
mutate(percent=round(total/sum(total),2)) %>%
select(grade, percent) %>%
mutate(grade=factor(grade), grade=factor(grade, levels=rev(levels(grade))))
grade
grade <- ct_loans %>%
group_by(grade) %>%
dplyr::summarise(total=n())
grade
grade <- ct_loans %>%
group_by(grade) %>%
dplyr::summarise(total=n()) %>%
mutate(percent=round(total/sum(total),2))
grade
grade <- ct_loans %>%
group_by(grade) %>%
summarise(total=n()) %>%
mutate(percent=round(total/sum(total),2)) %>%
select(grade, percent) %>%
mutate(grade=factor(grade), grade=factor(grade, levels=rev(levels(grade))))
library(dplyr)
grade <- ct_loans %>%
dplyr::group_by(grade) %>%
dplyr::summarise(total=n()) %>%
dplyr::mutate(percent=round(total/sum(total),2)) %>%
dplyr::select(grade, percent) %>%
dplyr::mutate(grade=factor(grade), grade=factor(grade, levels=rev(levels(grade))))
max(purpose$total)
max(purpose$average)
gg <- ggplot(purpose, aes(y=purpose, x=average))
gg <- gg + geom_lollipop(point.colour="royalblue", point.size=3, horizontal=TRUE)
gg <- gg + scale_x_continuous(expand=c(0,0),labels=dollar,
breaks=seq(0, 1, by=0.2), limits=c(0, 16500))
#gg <- gg + coord_flip()
gg <- gg + labs(x=NULL, y=NULL,
title="Average loan amount issued in Connecticut",
subtitle="By purpose. Lending Club data between 2007 and 2015.",
caption="Source: Kaggle, LendingClub")
gg <- gg + theme_minimal(base_family="Arial Narrow")
gg <- gg + theme(panel.grid.major.y=element_blank())
gg <- gg + theme(panel.grid.minor=element_blank())
gg <- gg + theme(axis.line.y=element_line(color="#2b2b2b", size=0.15))
gg <- gg + theme(axis.text.y=element_text(margin=margin(r=-5, l=0)))
gg <- gg + theme(plot.margin=unit(rep(30, 4), "pt"))
gg <- gg + theme(plot.title=element_text(face="bold"))
gg <- gg + theme(plot.subtitle=element_text(margin=margin(b=10)))
gg <- gg + theme(plot.caption=element_text(size=8, margin=margin(t=10)))
gg
write.csv(ct_loans, "data/ct_loans.csv")
